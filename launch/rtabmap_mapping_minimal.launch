<?xml version="1.0"?>

<launch>
  <arg name="geotiff_map_file_path" default="$(find hector_geotiff)/maps"/>
  <param name="/use_sim_time" value="false"/>

  <!-- <node pkg="tf" type="static_transform_publisher" name="static_tf_world_map"
        args="1 0 0 0 0 0 /world /map 100"/> -->

  <node pkg="rviz" type="rviz" name="rviz"
        args="-d $(find hector_slam_launch)/rviz_cfg/mapping_demo.rviz"/>

  <include file="$(find ros_x_habitat)/launch/hector_mapping_default.launch"/>

  <!-- <node pkg="tf" type="static_transform_publisher" name="base_to_laser"
        args="0 0 0 0 0 0 /base_frame /laser 100"/> -->

  <node pkg="nodelet" type="nodelet" name="rgbd_sync"
        args="standalone rtabmap_sync/rgbd_sync" output="screen">
    <remap from="rgb/image"       to="rgb"/>
    <remap from="depth/image"     to="depth"/>
    <remap from="rgb/camera_info" to="camera_info"/>
    <remap from="rgbd_image"      to="rgbd_image"/>
    <param name="approx_sync" value="true"/>
  </node>

  <node name="rtabmap" pkg="rtabmap_slam" type="rtabmap"
        output="screen" args="--delete_db_on_start">
    <param name="frame_id"        value="base_frame"/>
    <param name="subscribe_depth" value="false"/>
    <param name="subscribe_rgbd"  value="true"/>
    <param name="subscribe_scan"  value="true"/>
    <param name="queue_size"      value="10"/>

    <remap from="odom"       to="odom"/>
    <remap from="scan"       to="scan"/>
    <remap from="rgbd_image" to="rgbd_image"/>

    <param name="RGBD/NeighborLinkRefining" value="true"/>
    <param name="RGBD/ProximityBySpace"     value="true"/>
    <param name="RGBD/AngularUpdate"        value="0.05"/>
    <param name="RGBD/LinearUpdate"         value="0.05"/>
    <param name="RGBD/OptimizeFromGraphEnd" value="false"/>
    <param name="Grid/FromDepth"            value="false"/>
    <param name="Reg/Force3DoF"             value="true"/>
    <param name="Reg/Strategy"              value="0"/>
    <param name="Optimizer/Epsilon"         value="0"/>
    <param name="RGBD/CreateOccupancyGrid" value="false"/>
    <param name="Grid/3D" value="false"/>
    <param name="Grid/Sensor" value="0"/>
    <param name="Grid/CellSize"         value="0.05"/>
    <param name="Icp/VoxelSize"                  value="0.05"/>
    <param name="Icp/MaxCorrespondenceDistance"  value="0.1"/>
  </node>
</launch>
